/*

тЬЕ Higher-Order Function (HOF) ржХрзА?

ЁЯСЙ ржпрзЗ ржлрж╛ржВрж╢ржи ржЖрж░рзЗржХржЯрж╛ ржлрж╛ржВрж╢ржиржХрзЗ ржЗржиржкрзБржЯ рж╣рж┐рж╕рзЗржмрзЗ ржирзЗрзЯ, ржмрж╛ ржЖрж░рзЗржХржЯрж╛ ржлрж╛ржВрж╢ржиржХрзЗ рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рзЗ тАФ рж╕рзЗржЯрж╛ржЗ Higher-Order Functionред

ржЕрж░рзНржерж╛рзО:

function тЖТ function ржХрзЗ ржирзЗрзЯ / function тЖТ function ржлрзЗрж░ржд ржжрзЗрзЯ


//====================
тЬЕ рзз) Decode (ржбрж┐ржХрзЛржб)

decode ржорж╛ржирзЗ рж╢рзБржзрзБ token-ржПрж░ ржнрзЗрждрж░рзЗрж░ рждржерзНржп ржкрзЬрж╛ред

тЬФ Decode ржХрж░рж▓рзЗ ржХрзА рж╣рзЯ?

Token-ржПрж░ payload (ржпрзЗржоржи: id, email, role) ржкрзЬрзЗ ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯ

ржХрзЛржирзЛ ржирж┐рж░рж╛ржкрждрзНрждрж╛ (security) ржЪрзЗржХ рж╣рзЯ ржирж╛

Token valid ржирж╛ invalidтАФржЬрж╛ржирж╛ ржпрж╛рзЯ ржирж╛

ржЙржжрж╛рж╣рж░ржг:
const decoded = jwt.decode(token);
console.log(decoded);


тЮбя╕П ржПржЯрж╛ рж╢рзБржзрзБ тАЬtext ржЦрзБрж▓рзЗ ржжрзЗржЦрж╛тАЭ
тЮбя╕П Password ржЫрж╛рзЬрж╛ ржмржЗ ржкрзЬрж╛рж░ ржорждрзЛ

ржХрж┐ржирзНрждрзБ ржПржЯрж┐ ржпрж╛ржЪрж╛ржЗ ржХрж░рзЗ ржирж╛ token ржЖрж╕рж▓ ржирж╛ржХрж┐ ржиржХрж▓ред

тЬЕ рзи) Verify (ржнрзЗрж░рж┐ржлрж╛ржЗ)

verify ржорж╛ржирзЗ token ржЖрж╕рж▓ ржХрж┐ржирж╛ рж╕рзЗржЯрж╛ secret key ржжрж┐рзЯрзЗ ржЪрзЗржХ ржХрж░рж╛ред

тЬФ Verify ржХрж░рж▓рзЗ ржХрзА рж╣рзЯ?

Token-ржПрж░ signature check рж╣рзЯ

Token valid ржирж╛ржХрж┐ invalid тЖТ ржЬрж╛ржирж╛ ржпрж╛рзЯ

Token expire рж╣рж▓рзЗ error ржжрзЗрзЯ

ржиржХрж▓ token рж╣рж▓рзЗ error ржжрзЗрзЯ

ржЙржжрж╛рж╣рж░ржг:
const user = jwt.verify(token, process.env.JWT_SECRET);


тЮбя╕П Token-ржПрж░ authenticity ржкрж░рзАржХрзНрж╖рж╛ рж╣рзЯ
тЮбя╕П ржирж┐рж░рж╛ржкрждрзНрждрж╛ рззрзжрзж% ржирж┐рж╢рзНржЪрж┐ржд рж╣рзЯ

*/
